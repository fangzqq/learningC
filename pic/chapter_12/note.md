# 预处理器

- 使用 `#define` 语句创建自己的常量和宏
- 使用 `#include` 语句生成自己的库文件
- 使用 `#ifdef, #endif, #else, #ifndef` 等条件语句编写更强大的程序

## `#define` 语句

`#define` 语句不存在 __局部定义__，其可以出现在程序中的任意位置，但要求一个名字的定义出现在程序对它的引用之前。

预处理器会在每个出现已定义名字的地方逐一执行文本替换。

我们可以在定义中引用其他定义值，只要在程序中使用定义时，被引用值都已经完成定义即可。

### 参数与宏

```c
#define IS_LEAP_YEAR(y) y % 4 == 0 && y % 100 != 0 \
                        || y % 400 == 0
```

因为只是执行字面文本替换。所以没有定义参数 y 的类型。已定义名字与参数列表的左括号之间不允许存在空格。

拥有一个或多个参数的定义被称为宏。

宏与函数的比较：

- 在宏中，参数的类型并不重要.
- 宏使用的内存空间会多于等价定义的函数
- 函数的调用和返回都需要时间，而使用宏可以避免这一开销

### 可变数目的宏参数

```c
#define debugPrintf(...) printf("DEBUG:" __VA_ARGS__);
```

在参数列表的最后放三个点，表示接受可变数目的参数。列表中的其余参数由特定标识符 `__VA_AEGS__` 做整体引用。

### `#` 运算符

若在宏定义中的参数前放上 `#`，那么在调用这个宏时，预处理器会把这个宏参数生成一个常量字符串。

```c
#define str(x) # x
```

预处理器会在实际宏参数两边插入双引号。

### `##` 运算符

这个运算符用于将两个标记（token）联合在一起。它的前面或后面是宏的一个参数名。

```c
#define printx(n) printf("%i\n", x ## n)
// 调用 printx(20);
// 将被展开为 printf("%i\n, x20);
```

## `#include` 语句

利用 `#include` 语句将头文件或包含文件中的宏和函数都包含到程序中。头文件通常以字符 `.h` 结尾。

头文件中的所有语句都被看作是直接键入到程序中的相应位置。
